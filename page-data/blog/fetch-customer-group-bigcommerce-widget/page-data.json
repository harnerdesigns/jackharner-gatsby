{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/fetch-customer-group-bigcommerce-widget/","result":{"data":{"site":{"siteMetadata":{"title":"Jack Harner","description":"Jack Harner is a Freelance Web Developer & E-Commerce Consultant based in Denver, Colorado. Shopify, BigCommerce, WordPress Dev & More.","author":"@jackharner","siteUrl":"https://jackharner.com"}},"markdownRemark":{"html":"<p>Did you know you can fetch Customer data on the frontend in a custom BigCommerce Widget? If you didn't, well it's your lucky day because today I'm going to show you how.</p>\n<h2 id=\"schema-setup\" style=\"position:relative;\"><a href=\"#schema-setup\" aria-label=\"schema setup permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Schema Setup</h2>\n<p>This tutorial is going to assume you are using <a href=\"https://developer.bigcommerce.com/docs/ZG9jOjMwNzg1ODgz-widget-builder\">Bigcommerce's Widget Builder cli</a> and already have it configured to work with your specific store.  (I'll probably write a post about this as well.)</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"command-line-prompt\"><span data-user=jack data-host=localhost></span></span>$ widget-builder create customer-widget</code></pre></div>\n<p>That should pop open <code class=\"language-text\">localhost:8080</code> and generate the default folder file boilerplate with three files:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">customer-widget/\n  - config.json\n  - schema.json\n  - widget.html</code></pre></div>\n<p>In that same folder you're going to need to create a two new files:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">customer-widget/\n  - config.json\n  - schema.json\n  - widget.html\n+ - query.graphql\n+ - queryParamsBuilder.json</code></pre></div>\n<h3 id=\"setting-up-querygraphql-for-a-bc-widget\" style=\"position:relative;\"><a href=\"#setting-up-querygraphql-for-a-bc-widget\" aria-label=\"setting up querygraphql for a bc widget permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setting up query.graphql for a BC Widget</h3>\n<p>All this file does is hold the GraphQl query you want to run when the widget is placed. You can use this to fetch products, or customer data. Pretty much anything you can fetch with the Storefront GraphQL API you can bring in as data for a widget. For now we're just focusing on getting the Customer Group ID witch you can grab with this query:</p>\n<div class=\"gatsby-highlight\" data-language=\"graphql\"><pre class=\"language-graphql\"><code class=\"language-graphql\"><span class=\"token punctuation\">{</span>\n  <span class=\"token object\">customer</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">customerGroupId</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>I want to caveat this with the fact that there are many many many dumb things about BigCommerce Widgets ( they are getting better, and the widget-builder tool helps with a some of it ) so just make sure to test everything before comitting to doing something with widgets over baking it custom into the theme. (I've got a post planned for the things you  <strong>can't</strong> do with Widgets, so stay tuned for that)</p>\n<h3 id=\"whats-up-with-the-queryparamsbuilderjson-file\" style=\"position:relative;\"><a href=\"#whats-up-with-the-queryparamsbuilderjson-file\" aria-label=\"whats up with the queryparamsbuilderjson file permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What's up with the queryParamsBuilder.json file?</h3>\n<p>When you have more complex GraphQL queries like fetching products you'll probably need to take in a setting value and use it in the query. In the case of fetching the customer group you don't because there is only one customer object available and it's the user viewing the page.</p>\n<p>So for the sake of this article, the <code class=\"language-text\">queryParamsBuilder.json</code> is just an empty object:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>For whatever reason the query doesn't run if you don't include the file so you need both, even if you're not using any query params. This might change in the future so it might not be necessary after an update to the widget-builder cli</p>\n<h2 id=\"using-graphql-data-in-the-widget-template\" style=\"position:relative;\"><a href=\"#using-graphql-data-in-the-widget-template\" aria-label=\"using graphql data in the widget template permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Using GraphQL Data in the Widget Template</h2>\n<p>To get the data you just fetched in the template? The fetched data is added on to the <code class=\"language-text\">_</code> object so you can use it in your <code class=\"language-text\">widget.html</code> file like so:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">{{#if _.data.customer.customerGroupId \"==\" 1}}\n  // Do something when the customer is assigned\n  // to a customer group with the ID of 1\n{{/if}}</code></pre></div>\n<p>Obviously if you have a more complex query the logic will be much more complex. However, if you need to troubleshoot something, you can use the JSON handlebars helper: <code class=\"language-text\">{{json _.data}}</code> to see everything that's getting returned.</p>\n<h2 id=\"why-isnt-my-customer-object-populated-locally-with-widget-builder\" style=\"position:relative;\"><a href=\"#why-isnt-my-customer-object-populated-locally-with-widget-builder\" aria-label=\"why isnt my customer object populated locally with widget builder permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Why isn't my customer object populated locally with widget-builder?</h2>\n<p>When using the widget-builder CLI and fetching customer data from GraphQL, unfortunately with <code class=\"language-text\">widget-builder start</code> there (currently) isn't a way to attach a customer to the local version of the widget.\nOnce you get the widget published to the store it will start populating properly, but for now there's no way to spoof a customer locally while building a widget.</p>\n<h2 id=\"before-you-go\" style=\"position:relative;\"><a href=\"#before-you-go\" aria-label=\"before you go permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Before you go..</h2>\n<p>If you've made it this far, you're obviously someone who works on the more technical side of BigCommerce development. Given that, I think you might be interested in my post about setting up <a href=\"https://jackharner.com/blog/bigcommerce-stencil-ci-cd-with-github-actions/\">Continuous Integration / Deployment with GH Actions for BigCommerce Themes</a>.\nLet me know if you have any questions or if you've found something different tinkering with BigCommerce Widgets.</p>","excerpt":"Did you know you can fetch Customer data on the frontend in a custom BigCommerce Widget? If you didn't, well it's your lucky day because today I'm…","wordCount":{"words":554},"frontmatter":{"date":"February 24, 2023","updated":null,"title":"Fetch Customer Group & More in a BigCommerce Widget","subtitle":"","tags":["BigCommerce"],"featuredImage":{"absolutePath":"/home/runner/work/jackharner-gatsby/jackharner-gatsby/content/blog/fetch-customer-group-bigcommerce-widget/nick-page-ovav6SivMAY-unsplash.jpg","childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","backgroundColor":"#181818","images":{"fallback":{"src":"/static/b02f932755794a268445355f22de8062/5267c/nick-page-ovav6SivMAY-unsplash.jpg","srcSet":"/static/b02f932755794a268445355f22de8062/7284f/nick-page-ovav6SivMAY-unsplash.jpg 750w,\n/static/b02f932755794a268445355f22de8062/29ba9/nick-page-ovav6SivMAY-unsplash.jpg 1080w,\n/static/b02f932755794a268445355f22de8062/c8896/nick-page-ovav6SivMAY-unsplash.jpg 1366w,\n/static/b02f932755794a268445355f22de8062/5267c/nick-page-ovav6SivMAY-unsplash.jpg 1920w","sizes":"100vw"},"sources":[{"srcSet":"/static/b02f932755794a268445355f22de8062/57584/nick-page-ovav6SivMAY-unsplash.webp 750w,\n/static/b02f932755794a268445355f22de8062/984df/nick-page-ovav6SivMAY-unsplash.webp 1080w,\n/static/b02f932755794a268445355f22de8062/4a276/nick-page-ovav6SivMAY-unsplash.webp 1366w,\n/static/b02f932755794a268445355f22de8062/9c00f/nick-page-ovav6SivMAY-unsplash.webp 1920w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.6666666666666666}}},"ogImage":{"absolutePath":"/home/runner/work/jackharner-gatsby/jackharner-gatsby/content/blog/fetch-customer-group-bigcommerce-widget/nick-page-ovav6SivMAY-unsplash.jpg","childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#181818","images":{"fallback":{"src":"/static/b02f932755794a268445355f22de8062/fcb2f/nick-page-ovav6SivMAY-unsplash.jpg","srcSet":"/static/b02f932755794a268445355f22de8062/f1930/nick-page-ovav6SivMAY-unsplash.jpg 300w,\n/static/b02f932755794a268445355f22de8062/550ca/nick-page-ovav6SivMAY-unsplash.jpg 600w,\n/static/b02f932755794a268445355f22de8062/fcb2f/nick-page-ovav6SivMAY-unsplash.jpg 1200w,\n/static/b02f932755794a268445355f22de8062/ccec0/nick-page-ovav6SivMAY-unsplash.jpg 2400w","sizes":"(min-width: 1200px) 1200px, 100vw"},"sources":[{"srcSet":"/static/b02f932755794a268445355f22de8062/c7da1/nick-page-ovav6SivMAY-unsplash.webp 300w,\n/static/b02f932755794a268445355f22de8062/22c65/nick-page-ovav6SivMAY-unsplash.webp 600w,\n/static/b02f932755794a268445355f22de8062/81547/nick-page-ovav6SivMAY-unsplash.webp 1200w,\n/static/b02f932755794a268445355f22de8062/19ade/nick-page-ovav6SivMAY-unsplash.webp 2400w","type":"image/webp","sizes":"(min-width: 1200px) 1200px, 100vw"}]},"width":1200,"height":630}}}},"fields":{"externalLink":"","externalLinkLabel":"Check It Out »","slug":"/blog/fetch-customer-group-bigcommerce-widget/","ogImage":"./nick-page-ovav6SivMAY-unsplash.jpg","date":"February 24, 2023","unlisted":false}}},"pageContext":{"slug":"/blog/fetch-customer-group-bigcommerce-widget/","related":[{"id":"1732511e-0852-527d-b359-940d470ea8b0","excerpt":"After wanting one for some time, I finally caved and bought a Raspberry Pi. I got the Pi 4 Model B, the latest and greatest. It boasts the…","fields":{"date":"2020-05-30T02:06:06.076Z","slug":"/blog/i-just-got-a-raspberry-pi/","collection":"blog","published":true,"externalLink":"","externalLinkLabel":"Check It Out »"},"frontmatter":{"title":"I Just Got A Raspberry Pi","subtitle":"PiHole, DNS, Oh My!","tags":["Raspberry Pi","Linux"],"published":true,"featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f898b8","images":{"fallback":{"src":"/static/f981484910e686b1685b12026887ba82/98e16/featuredImage.jpg","srcSet":"/static/f981484910e686b1685b12026887ba82/b5dbb/featuredImage.jpg 167w,\n/static/f981484910e686b1685b12026887ba82/97cfb/featuredImage.jpg 334w,\n/static/f981484910e686b1685b12026887ba82/98e16/featuredImage.jpg 667w,\n/static/f981484910e686b1685b12026887ba82/f0b90/featuredImage.jpg 1334w","sizes":"(min-width: 667px) 667px, 100vw"},"sources":[{"srcSet":"/static/f981484910e686b1685b12026887ba82/bcba2/featuredImage.webp 167w,\n/static/f981484910e686b1685b12026887ba82/fb036/featuredImage.webp 334w,\n/static/f981484910e686b1685b12026887ba82/bbe13/featuredImage.webp 667w,\n/static/f981484910e686b1685b12026887ba82/994d2/featuredImage.webp 1334w","type":"image/webp","sizes":"(min-width: 667px) 667px, 100vw"}]},"width":667,"height":350}}}}},{"id":"7ed404b5-c486-5e54-b3ce-969717642fb8","excerpt":"Becoming a Full Time Freelancer without a Computer Science Degree 😉 I was asked to interview on the No CS Degree blog. The blog focuses on…","fields":{"date":"2022-12-16T17:14:33.962Z","slug":"/blog/no-cs-degree/","collection":"blog","published":true,"externalLink":"https://www.nocsdegree.com/self-taught-shopify-developer/","externalLinkLabel":"Check It Out »"},"frontmatter":{"title":"No CS Degree","subtitle":null,"tags":["Freelance"],"published":true,"featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#f82828","images":{"fallback":{"src":"/static/01ac62b3978efb223c975f812e2d91a8/254bc/featured-image.png","srcSet":"/static/01ac62b3978efb223c975f812e2d91a8/c2a4a/featured-image.png 167w,\n/static/01ac62b3978efb223c975f812e2d91a8/fe850/featured-image.png 334w,\n/static/01ac62b3978efb223c975f812e2d91a8/254bc/featured-image.png 667w,\n/static/01ac62b3978efb223c975f812e2d91a8/6f72c/featured-image.png 1334w","sizes":"(min-width: 667px) 667px, 100vw"},"sources":[{"srcSet":"/static/01ac62b3978efb223c975f812e2d91a8/bcba2/featured-image.webp 167w,\n/static/01ac62b3978efb223c975f812e2d91a8/fb036/featured-image.webp 334w,\n/static/01ac62b3978efb223c975f812e2d91a8/bbe13/featured-image.webp 667w,\n/static/01ac62b3978efb223c975f812e2d91a8/994d2/featured-image.webp 1334w","type":"image/webp","sizes":"(min-width: 667px) 667px, 100vw"}]},"width":667,"height":350}}}}},{"id":"2cf50020-f31f-5b7f-b1e4-9ee941e40093","excerpt":"At Shoolu, we take advantage of Custom Fields on products in BigCommerce all the time. Our inventory software runs some rules against the…","fields":{"date":"2020-06-09T16:35:09.669Z","slug":"/blog/get-custom-field-by-name-bigcommerce-stencil/","collection":"blog","published":true,"externalLink":"","externalLinkLabel":"Check It Out »"},"frontmatter":{"title":"Custom Fields By Name","subtitle":"In BigCommerce Stencil Themes","tags":["BigCommerce","Tutorial"],"published":true,"featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#a8b8c8","images":{"fallback":{"src":"/static/1d3a10e71aba0aa2c3229f08e3521000/f674c/featured-image.jpg","srcSet":"/static/1d3a10e71aba0aa2c3229f08e3521000/329bc/featured-image.jpg 156w,\n/static/1d3a10e71aba0aa2c3229f08e3521000/20b50/featured-image.jpg 312w,\n/static/1d3a10e71aba0aa2c3229f08e3521000/f674c/featured-image.jpg 623w,\n/static/1d3a10e71aba0aa2c3229f08e3521000/344b2/featured-image.jpg 1246w","sizes":"(min-width: 623px) 623px, 100vw"},"sources":[{"srcSet":"/static/1d3a10e71aba0aa2c3229f08e3521000/ad4f0/featured-image.webp 156w,\n/static/1d3a10e71aba0aa2c3229f08e3521000/6c059/featured-image.webp 312w,\n/static/1d3a10e71aba0aa2c3229f08e3521000/4b1b8/featured-image.webp 623w,\n/static/1d3a10e71aba0aa2c3229f08e3521000/de033/featured-image.webp 1246w","type":"image/webp","sizes":"(min-width: 623px) 623px, 100vw"}]},"width":623,"height":350}}}}},{"id":"7d4b8aec-6a85-58e1-bafe-079f2d257e0e","excerpt":"Do you frequently update WordPress themes? It's kind of a pain in the ass, right?  Typically has to be done manually through FTP or…","fields":{"date":"2018-09-11T05:33:10.000Z","slug":"/blog/pushing-wordpress-theme-updates-with-git/","collection":"blog","published":true,"externalLink":"","externalLinkLabel":"Check It Out »"},"frontmatter":{"title":"Pushing WordPress Theme Updates With Git","subtitle":"","tags":["WordPress","Git","Automation"],"published":true,"featuredImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#e81868","images":{"fallback":{"src":"/static/124be52bbf346d8c60c354150e3cbdd7/83513/featuredImage.png","srcSet":"/static/124be52bbf346d8c60c354150e3cbdd7/524f8/featuredImage.png 172w,\n/static/124be52bbf346d8c60c354150e3cbdd7/9c87a/featuredImage.png 344w,\n/static/124be52bbf346d8c60c354150e3cbdd7/83513/featuredImage.png 687w,\n/static/124be52bbf346d8c60c354150e3cbdd7/f8354/featuredImage.png 1374w","sizes":"(min-width: 687px) 687px, 100vw"},"sources":[{"srcSet":"/static/124be52bbf346d8c60c354150e3cbdd7/fa0cb/featuredImage.webp 172w,\n/static/124be52bbf346d8c60c354150e3cbdd7/470f7/featuredImage.webp 344w,\n/static/124be52bbf346d8c60c354150e3cbdd7/a5f32/featuredImage.webp 687w,\n/static/124be52bbf346d8c60c354150e3cbdd7/a73ea/featuredImage.webp 1374w","type":"image/webp","sizes":"(min-width: 687px) 687px, 100vw"}]},"width":687,"height":350}}}}}]}},"staticQueryHashes":["3649515864","764694655"],"slicesMap":{}}